I"È<p>å°èœè®°å½•åœ¨centos7æœåŠ¡ä¸Šå®‰è£…PostgreSQLã€‚</p>

<p>â— <a href="https://www.jianshu.com/p/342f887838c8" title="https://www.jianshu.com/p/342f887838c8" target="_blank">ç®€ä¹¦åŸè´´åšå®¢</a></p>

<h1 id="1å®‰è£…postgresql">1.å®‰è£…PostgreSQL</h1>

<p>åœ¨å®˜ç½‘åœ°å€<a href="https://www.postgresql.org/download/linux/redhat/" title="https://www.postgresql.org/download/linux/redhat/" target="_blank">ä¼ é€é—¨</a>
é€‰æ‹©å¥½é€‰é¡¹åä¼šè‡ªå·±ç”Ÿæˆé…ç½®ã€‚</p>

<p><img src="http://walidream.com:9999/blogImage/sql/sql_1.png" alt="ssl" /></p>

<h3 id="å®‰è£…rpm">å®‰è£…RPM</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yum install https://download.postgresql.org/pub/repos/yum/9.6/redhat/rhel-7-x86_64/pgdg-centos96-9.6-3.noarch.rpm
</code></pre></div></div>

<h3 id="å®‰è£…å®¢æˆ·ç«¯åŒ…">å®‰è£…å®¢æˆ·ç«¯åŒ…</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yum install postgresql96
</code></pre></div></div>

<h3 id="å®‰è£…postgresql-96">å®‰è£…PostgreSQL 9.6</h3>

<ul>
  <li>postgresql96-server  æ•°æ®åº“æ ¸å¿ƒæœåŠ¡ç«¯</li>
  <li>postgresql96-contrib  é™„åŠ ç¬¬ä¸‰æ–¹æ‰©å±•</li>
  <li>postgresql96-devel  Cè¯­è¨€å¼€å‘Headerå¤´æ–‡ä»¶å’Œåº“</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yum install postgresql96-server postgresql96-contrib postgresql96-devel
</code></pre></div></div>

<h3 id="éªŒè¯æ˜¯å¦å®‰è£…æˆåŠŸ">éªŒè¯æ˜¯å¦å®‰è£…æˆåŠŸ</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rpm -aq| grep postgres
</code></pre></div></div>

<p>é»˜è®¤Postgresqlæ•°æ®åº“è·¯å¾„æ˜¯ <code class="language-plaintext highlighter-rouge">/var/lib/pgsql/9.6/data</code> ï¼Œå¯ä»¥æ–°å»ºä¸€ä¸ªç›®å½•ï¼Œå‡å¦‚æ˜¯/mnt/vdb1</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cd /mnt
sudo mkdir vdb1
sudo chown -R postgres:postgres vdb1
sudo chmod 700 vdb1
vi /usr/lib/systemd/system/postgresql-9.6.service
Environment=PGDATA=/mnt/vdb1/Â  ä¿®æ”¹ä¸ºè‡ªå·±çš„æ–°çš„æ•°æ®è·¯å¾„
</code></pre></div></div>

<h3 id="åˆå§‹åŒ–æ•°æ®åº“">åˆå§‹åŒ–æ•°æ®åº“</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/usr/pgsql-9.6/bin/postgresql96-setup initdb
</code></pre></div></div>

<h3 id="å¼€å¯æœåŠ¡">å¼€å¯æœåŠ¡</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>systemctl enable postgresql-9.6  #å…³é—­æœåŠ¡
systemctl start postgresql-9.6   #å¯åŠ¨æœåŠ¡
</code></pre></div></div>

<h3 id="å¼€æœºå¯åŠ¨">å¼€æœºå¯åŠ¨</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo chkconfig postgresql-9.6 on  
systemctl enable postgresql-9.6.service
</code></pre></div></div>

<h3 id="ä¿®æ”¹å¯†ç ">ä¿®æ”¹å¯†ç </h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>su postgres

psql

ALTER USER postgres WITH PASSWORD 'å¯†ç ';   --å¿…é¡»ä»¥åˆ†å·ç»“æŸï¼ŒæˆåŠŸæ‰§è¡Œåä¼šå‡ºç°ALTER ROLE

\q

su root
</code></pre></div></div>

<h3 id="å¼€å¯è¿œç¨‹è®¿é—®">å¼€å¯è¿œç¨‹è®¿é—®</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vi /var/lib/pgsql/9.6/data/postgresql.conf  
æˆ–è€…
vi /mnt/vdb1/postgresql.conf
</code></pre></div></div>

<p>ä¿®æ”¹#listen_addresses = â€˜localhostâ€™  ä¸º  listen_addresses=â€™*â€™</p>

<p>å½“ç„¶ï¼Œæ­¤<code class="language-plaintext highlighter-rouge">*</code>ä¹Ÿå¯ä»¥æ”¹ä¸ºä»»ä½•ä½ æƒ³å¼€æ”¾çš„æœåŠ¡å™¨IP</p>

<p><img src="http://walidream.com:9999/blogImage/sql/sql_2.png" alt="ssl" /></p>

<h3 id="ä¿¡ä»»è¿œç¨‹è¿æ¥">ä¿¡ä»»è¿œç¨‹è¿æ¥</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vi /var/lib/pgsql/9.6/data/pg_hba.conf  æˆ–è€…  vi /mnt/vdb1/pg_hba.conf
</code></pre></div></div>

<p>ä¿®æ”¹å¦‚ä¸‹å†…å®¹ï¼Œä¿¡ä»»æŒ‡å®šæœåŠ¡å™¨è¿æ¥</p>

<h1 id="ipv4-local-connections">IPv4 local connections:</h1>

<p>hostÂ  Â  allÂ  Â  Â  Â  Â  Â  allÂ  Â  Â  127.0.0.1/32Â  Â  Â  md5</p>

<p>host    all             all             0.0.0.0/32            trust
host    all             all             0.0.0.0/24            trust
host    all             all             0.0.0.0/0             trust</p>

<p><img src="http://walidream.com:9999/blogImage/sql/sql_3.png" alt="ssl" /></p>

<h3 id="é‡å¯æœåŠ¡">é‡å¯æœåŠ¡</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>service postgresql-9.6 restart æˆ–è€… systemctl restart postgresql-9.6.service
</code></pre></div></div>

<h3 id="æ‰“å¼€é˜²ç«å¢™">æ‰“å¼€é˜²ç«å¢™</h3>

<p>CentOS é˜²ç«å¢™ä¸­å†…ç½®äº†PostgreSQLæœåŠ¡ï¼Œé…ç½®æ–‡ä»¶ä½ç½®åœ¨<code class="language-plaintext highlighter-rouge">/usr/lib/firewalld/services/postgresql.xml</code>ï¼Œæˆ‘ä»¬åªéœ€ä»¥æœåŠ¡æ–¹å¼å°†PostgreSQLæœåŠ¡å¼€æ”¾å³å¯ã€‚</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>systemctl enable firewalld #å¼€æœºå¯ç”¨é˜²ç«å¢™

systemctl start firewalld #å¼€å¯é˜²ç«å¢™

firewall-cmd --add-service=postgresql --permanent   #å¼€æ”¾postgresqlæœåŠ¡

firewall-cmd --zone=public --add-port=5432/tcp --permanent #æˆ–è€…å¯ä»¥ç›´æ¥æ·»åŠ ç«¯å£

firewall-cmd --reload  #é‡è½½é˜²ç«å¢™

firewall-cmd --list-ports # æŸ¥çœ‹å ç”¨ç«¯å£
</code></pre></div></div>

<h3 id="ç®€å•ä½¿ç”¨">ç®€å•ä½¿ç”¨</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>psql -U postgres postgres  è¿æ¥æ•°æ®åº“

è¯´æ˜ï¼š-hè¡¨ç¤ºä¸»æœºï¼ˆHostï¼‰ï¼Œ-pè¡¨ç¤ºç«¯å£ï¼ˆPortï¼‰ï¼Œ-Uè¡¨ç¤ºç”¨æˆ·ï¼ˆUserï¼‰

æ˜¾ç¤ºæ‰€æœ‰æ•°æ®åº“ï¼š \l
</code></pre></div></div>

<h3 id="å¸è½½postgresql">å¸è½½PostgreSQL</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yum erase postgresql96
</code></pre></div></div>

<h1 id="2è¿œç¨‹è¿æ¥æµ‹è¯•">2.è¿œç¨‹è¿æ¥æµ‹è¯•</h1>

<p>å¦‚æœè¿˜æ²¡å®‰è£…navicatè½¯ä»¶ï¼Œå‚è€ƒæˆ‘ä¹‹å‰çš„å¸–å­<a href="/sql/2019/04/03/sql-1.html" title="/sql/2019/04/03/sql-1.html" target="_blank">ä¼ é€é—¨</a></p>

<h3 id="å¼€æ”¾æœåŠ¡å™¨ç«¯å£è®¿é—®">å¼€æ”¾æœåŠ¡å™¨ç«¯å£è®¿é—®</h3>

<p>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯å½“å‰é¢çš„å·¥ä½œåšå®Œä¹‹åï¼Œä¸€å®šè¦æ£€æŸ¥é˜¿é‡Œäº‘å®ä¾‹çš„æ•°æ®åº“ç«¯å£æ˜¯å¦å¼€æ”¾ï¼Œå¦‚æœæ²¡æœ‰å¼€æ”¾ï¼Œé‚£ä¹ˆè¦å…è®¸å¤–ç½‘è®¿é—®æ•°æ®åº“ä¸ç„¶æ˜¯è¿æ¥ä¸æˆåŠŸçš„ã€‚</p>

<p><img src="http://walidream.com:9999/blogImage/sql/sql_6.png" alt="ssl" /></p>

<p>æ‰“å¼€Navicatè½¯ä»¶,æ–°å»ºè¿æ¥ï¼Œé€‰æ‹©è‡ªå·±è¦è¿æ¥çš„æ•°æ®åº“ç±»å‹</p>

<p><img src="http://walidream.com:9999/blogImage/sql/sql_7.png" alt="ssl" /></p>

:ET