I"­<p>nginxæ—¥å¿—ç±»å‹æœ‰ä¸¤ç§ï¼Œç¬¬ä¸€ç§æ˜¯<code class="language-plaintext highlighter-rouge">error.log</code>æ—¥å¿—ï¼Œç¬¬äºŒç§æ˜¯<code class="language-plaintext highlighter-rouge">access_log</code>æ—¥å¿—ã€‚error.logæ˜¯è®°å½•é”™è¯¯ï¼Œaccess_logç”¨æ¥æŒ‡å®šæ—¥å¿—æ–‡ä»¶çš„å­˜æ”¾è·¯å¾„ã€æ ¼å¼ï¼ˆæŠŠå®šä¹‰çš„log_format è·Ÿåœ¨åé¢ï¼‰å’Œç¼“å­˜å¤§å°ï¼›å¦‚æœä¸æƒ³å¯ç”¨æ—¥å¿—åˆ™access_log off ;</p>

<h1 id="1log_formaté…ç½®è¯­æ³•">1.log_formaté…ç½®è¯­æ³•</h1>

<p>ä½œç”¨ï¼šç”¨æ¥è®¾ç½®æ—¥å¿—æ ¼å¼</p>

<p>è¯­æ³•:</p>

<div class="language-nginx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">syntax:</span> <span class="s">log_format</span> <span class="s">name</span> <span class="s">[escape=default</span> <span class="s">|</span> <span class="s">json]</span> <span class="s">string</span> <span class="s">...</span><span class="p">;</span>
<span class="k">default:</span> <span class="s">log_format</span> <span class="s">combined</span> <span class="s">"..."</span><span class="p">;</span>
<span class="k">context:</span> <span class="s">http</span>
</code></pre></div></div>

<h1 id="2nginxå˜é‡">2.nginxå˜é‡</h1>

<h3 id="1httpè¯·æ±‚å˜é‡">1.httpè¯·æ±‚å˜é‡</h3>

<p>arg_PAPAMENTER(å‚æ•°)ã€http_HEADER(è¯·æ±‚å¤´)ã€send_http_HEADER(å“åº”å¤´ä¿¡æ¯)</p>

<div class="language-nginx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">log_format</span>  <span class="s">main</span>  <span class="s">'</span><span class="nv">$http_user_agent</span> <span class="nv">$remote_addr</span> <span class="s">-</span> <span class="nv">$remote_user</span> <span class="s">[</span><span class="nv">$time_local</span><span class="s">]</span> <span class="s">"</span><span class="nv">$request</span><span class="s">"</span> <span class="s">'</span>
                  <span class="s">'</span><span class="nv">$status</span> <span class="nv">$body_bytes_sent</span> <span class="s">"</span><span class="nv">$http_referer</span><span class="s">"</span> <span class="s">'</span>
                  <span class="s">'"</span><span class="nv">$http_user_agent</span><span class="s">"</span> <span class="s">"</span><span class="nv">$http_x_forwarded_for</span><span class="s">"'</span><span class="p">;</span>

 <span class="k">access_log</span>  <span class="n">/var/log/nginx/access.log</span>  <span class="s">main</span><span class="p">;</span>

</code></pre></div></div>
<p>åœ¨è¯·æ±‚å¤´ä¸­è·ç¦»è¦è·å–User-Agentä¿¡æ¯ï¼Œåˆ™ â€˜$http_user_agentâ€™å¤§å†™è½¬æˆå°å†™ï¼Œ<code class="language-plaintext highlighter-rouge">-</code>è½¬æ¢æˆ<code class="language-plaintext highlighter-rouge">_</code>è®°ä½è¦ç”¨<code class="language-plaintext highlighter-rouge">''å¼•èµ·æ¥</code>ï¼Œåœ¨<code class="language-plaintext highlighter-rouge">''</code>å¼•å·å†…[],-éƒ½ä¼šè¢«å¤„ç†æˆå­—ç¬¦ä¸²è¾“å‡º</p>

<h3 id="2å†…ç½®å˜é‡">2.å†…ç½®å˜é‡</h3>

<p>åœ¨nginxå®˜æ–¹ç½‘ç«™<code class="language-plaintext highlighter-rouge">Logging to syslog</code>ä¸­æŸ¥æ‰¾ï¼Œå˜é‡å¤ªå¤šä¸èƒ½åˆ—ä¸¾å‡ºæ¥ã€‚<a href="http://nginx.org/en/docs/http/ngx_http_log_module.html#log_format" title="http://nginx.org/en/docs/http/ngx_http_log_module.html#log_format" target="_blank">ä¼ é€é—¨</a></p>

:ET