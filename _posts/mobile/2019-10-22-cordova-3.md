---
layout: post
title: cordova-plugin-wechat 微信登录(3) #标题
tagline: cordova-plugin-wechat插件 微信登录
category: mobile      #分类
author: wali    #作者
tag: cordova     #标签
ghurl:        #github url
ghurl_zip:   #github zip下载
comments: true

post_nav: ["1.创建微信应用","2.添加插件","3.在web工程调用"]
group_tag: cordova 教程
---

在上小节介绍了cordova中如何使用`cordova-plugin-wechat`

- [cordova-plugin-wechat](https://www.npmjs.com/package/cordova-plugin-wechat "https://www.npmjs.com/package/cordova-plugin-wechat")

- [微信开发文档](https://developers.weixin.qq.com/doc/oplatform/Mobile_App/Resource_Center_Homepage.html "https://developers.weixin.qq.com/doc/oplatform/Mobile_App/Resource_Center_Homepage.html")

# 1.创建微信应用

在[微信开放平台](https://open.weixin.qq.com/ "https://open.weixin.qq.com/")注册一个账号，然后创建一个应用，填写相应的资料，最后提交等待审核。

![ssl](https://raw.githubusercontent.com/walidream/waliblog/gh-pages/static/image/mobile/mobile_4.png)

审核通过后，就会获得`AppID` 和 `AppSecret`

# 2.添加插件

在添加插件前，请先创建一个cordova项目，参考第一小节。

```txt
cordova plugin add cordova-plugin-wechat  --variable wechatappid=YOUR_WECHAT_APPID

cordova build android
```

# 3.在web工程调用

#### www/index.html

```html
<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Security-Policy" content="default-src 'self' data: gap: https://ssl.gstatic.com 'unsafe-eval'; style-src 'self' 'unsafe-inline'; media-src *; img-src 'self' data: content:;">
        <meta name="format-detection" content="telephone=no">
        <meta name="msapplication-tap-highlight" content="no">
        <meta name="viewport" content="initial-scale=1, width=device-width, viewport-fit=cover">
        <link rel="stylesheet" type="text/css" href="css/index.css">
        <title>Hello World</title>
    </head>
    <body>
        <div class="app">
            <h1>Apache Cordova</h1>
			<button id="wechat">微信</button>
            <div id="deviceready" class="blink">
                <p class="event listening">Connecting to Device</p>
                <p class="event received">Device is Ready</p>
            </div>
        </div>
        <script type="text/javascript" src="cordova.js"></script>
        <script type="text/javascript" src="js/index.js"></script>
    </body>
</html>

```

#### www/js/index.js

```javascript
//代码最后添加
document.getElementById('wechat').addEventListener('click', function () {
    var scope = "snsapi_userinfo";
    var state = "_" + (+new Date());
    Wechat.auth(scope, state, function (response) {
        // you may use response.code to get the access token.
        alert(JSON.stringify(response));
    }, function (reason) {
        alert("Failed: " + reason);
    });
})
```
![ssl](https://raw.githubusercontent.com/walidream/waliblog/gh-pages/static/image/mobile/mobile_5.png)
















