---
layout: post
title: nginx 日志(7)  #标题
tagline: 基于Nginx的中间架构
category: nginx      #分类
author: wali    #作者
tag: nginx     #标签
ghurl:        #github url
ghurl_zip:    #github zip下载
comments: true

post_nav: false
group_tag: nginx教程
---

nginx日志类型有两种，第一种是`error.log`日志，第二种是`access_log`日志。error.log是记录错误，access_log用来指定日志文件的存放路径、格式（把定义的log_format 跟在后面）和缓存大小；如果不想启用日志则access_log off ;

# 1.log_format配置语法

作用：用来设置日志格式

语法:

```nginx
syntax: log_format name [escape=default | json] string ...;
default: log_format combined "...";
context: http
```

# 2.nginx变量

### 1.http请求变量

arg_PAPAMENTER(参数)、http_HEADER(请求头)、send_http_HEADER(响应头信息)

```nginx
log_format  main  '$http_user_agent $remote_addr - $remote_user [$time_local] "$request" '
                  '$status $body_bytes_sent "$http_referer" '
                  '"$http_user_agent" "$http_x_forwarded_for"';

 access_log  /var/log/nginx/access.log  main;

```
在请求头中距离要获取User-Agent信息，则 '$http_user_agent'大写转成小写，`-`转换成`_`记住要用`''引起来`，在`''`引号内[],-都会被处理成字符串输出

### 2.内置变量

在nginx官方网站`Logging to syslog`中查找，变量太多不能列举出来。[传送门](http://nginx.org/en/docs/http/ngx_http_log_module.html#log_format "http://nginx.org/en/docs/http/ngx_http_log_module.html#log_format"){:target="_blank"}


