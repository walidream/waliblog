---
layout: post
title: '[深] nginx rewrite规则(23)'  #标题
tagline: nginx rewrite规则作用 (深度学习)
category: nginx      #分类
author: wali    #作者
tag: nginx     #标签
ghurl:        #github url
ghurl_zip:    #github zip下载
comments: true

post_nav: false
---

nginx Rewrite规则可以让网站的url中达到某种状态时定向/跳转到某个规则，可以实现很多功能。

- url访问跳转，支持开发设计，页面跳转、兼容性支持、展示效果、301重定向等。
- SEO优化
- 维护，流量转发
- 安全，如伪静态

#### 内置的全局变量

变量名|描述|
-|-
$args|这个变量等于请求行中的参数，同$query_string|
$content_length|请求头中的Content-length字段|
$content_type|请求头中的Content-Type字段|
$document_root|当前请求在root指令中指定的值|
$host|请求主机头字段，否则为服务器名称|
$http_user_agent|客户端agent信息|
$http_cookie|客户端cookie信息|
$limit_rate|这个变量可以限制连接速率|
$request_method|客户端请求的动作，通常为GET或POST|
$remote_addr|客户端的IP地址|
$remote_port|客户端的端口|
$remote_user|已经经过Auth Basic Module验证的用户名|
$request_filename|当前请求的文件路径，由root或alias指令与URI请求生成|
$scheme|HTTP方法（如http，https）|
$server_protocol|请求使用的协议，通常是HTTP/1.0或HTTP/1.1|
$server_addr|服务器地址，在完成一次系统调用后可以确定这个值|
$server_name|服务器名称|
$server_port|请求到达服务器的端口号|
$request_uri|包含请求参数的原始URI，不包含主机名，如：”/foo/bar.php?arg=baz”|
$uri|不带请求参数的当前URI，$uri不包含主机名，如”/foo/bar.html”|
$document_uri|与$uri相同|
	
	
# rewrite模块

rewrite配置项属于`ngx_http_rewrite_module`模块[传送门](http://nginx.org/en/docs/http/ngx_http_rewrite_module.html "http://nginx.org/en/docs/http/ngx_http_rewrite_module.html"){:target="_blank"}
	
#### rewrite 

```nginx
Syntax:	rewrite regex replacement [flag];  #匹配规则 定向路径 标志参数
Default: —
Context: server, location, if
```	

　　

flag选项|描述|
-|-
last|停止处理当前的ngx_http_rewrite_module指令集并开始搜索与更改的URI匹配的新位置|
break|与break指令一样，停止处理当前的ngx_http_rewrite_module指令集|
redirect|返回带有302代码的临时重定向;如果替换字符串不以“http：//”，“https：//”或“$scheme”|
permanent|返回301代码的永久重定向|

#### break

停止处理当前的ngx_http_rewrite_module指令集。

```nginx
Syntax:	break;
Default: —
Context: server, location, if
```	

#### if

如果为true，则执行在大括号内指定的此模块指令，并在if指令内为该请求分配配置

```nginx
Syntax:	if (condition) { ... }
Default: —
Context: server, location
```	
	
条件可以是以下任何一种：

- 如果变量的值为空字符串或“0”，则为false;
- 使用`=`和`!=运算符比较变量和字符串;
- 使用`~`（对于区分大小写的匹配）和`~*`（对于不区分大小写的匹配）运算符，将变量与正则表达式进行匹配。正则表达式可以包含可供以后在$1 .. $9变量中重用的捕获。负操作符`!~`和`!~*`也可用。如果正则表达式包含`}`或`;`字符，则整个表达式应包含在单引号或双引号中。
- 使用`-f`和`!-f`运算符检查文件是否存在
- 使用`-d`和`!-d`运算符检查目录是否存在
- 使用`-e`和`!-e`运算符检查文件，目录或符号链接是否存在
- 使用`-x`和`!-x`运算符检查可执行文件。





















































































	
	