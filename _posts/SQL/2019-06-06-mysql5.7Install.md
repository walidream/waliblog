---
layout: post
title: mysql  CentOS 7下 MySQL 5.7 的安装与配置 #标题
tagline: mysql CentOS 7下 MySQL 5.7 的安装与配置
category: SQL      #分类
author: wali    #作者
tag: mySQL     #标签
ghurl:        #github url
ghurl_zip:    #github zip下载
comments: true
post_nav: ["1.配置yum源","2.安装MySQL","3.启动MySQL服务","4.设置开机启动","5.添加远程登录用户","6.设置默认编码为utf8","7.默认配置文件路径"]
group_tag: mysql 安装教程
---

本文是小菜由下面帖子复制过来的，亲测安装成功。为了防止后面个人需要或帖子因为某些原因找不到，因此小菜将此贴收藏，建议大家还是阅读原贴，特此声明！

- [此贴原文 博主lancely CentOS 7 下 MySQL 5.7 的安装与配置](https://www.jianshu.com/p/1dab9a4d0d5f "https://www.jianshu.com/p/1dab9a4d0d5f")

本文测试环境：
- CentOS 7 64-bit Minimal
- MySQL 5.7

# 1.配置yum源

在 [https://dev.mysql.com/downloads/repo/yum/](https://dev.mysql.com/downloads/repo/yum/ "https://dev.mysql.com/downloads/repo/yum/") 找到 yum 源 rpm 安装包

![ssl](http://walidream.com:9999/blogImage/sql/sql_8.png)

#### 安装 mysql 源

```linux
# 下载
wget https://dev.mysql.com/get/mysql57-community-release-el7-11.noarch.rpm
# 安装 mysql 源
yum localinstall mysql57-community-release-el7-11.noarch.rpm
```

用下面的命令检查 mysql 源是否安装成功

```linux
yum repolist enabled | grep "mysql.*-community.*"
```

![ssl](http://walidream.com:9999/blogImage/sql/sql_9.png)


# 2.安装MySQL

使用 yum install 命令安装

```linux
yum install -y mysql-community-server
```

# 3.启动MySQL服务

在 CentOS 7 下，新的启动/关闭服务的命令是 `systemctl start|stop`

```linux
systemctl start mysqld
```

用 `systemctl status` 查看 MySQL 状态

```linux
systemctl status mysqld
```

![ssl](http://walidream.com:9999/blogImage/sql/sql_10.png)


# 4.设置开机启动

```linux
systemctl enable mysqld
# 重载所有修改过的配置文件
systemctl daemon-reload
```

#### 修改 root 本地账户密码

mysql 安装完成之后，生成的默认密码在 `/var/log/mysqld.log` 文件中。使用 grep 命令找到日志中的密码。

```linux
grep 'temporary password' /var/log/mysqld.log
```

#### 首次通过初始密码登录后，使用以下命令修改密码

```linux
mysql -uroot -p
mysql> ALTER USER 'root'@'localhost' IDENTIFIED BY 'MyNewPass4!'; 
```
或者

```linux
set password for 'root'@'localhost'=password('MyNewPass4!'); 
```

以后通过 `update set`语句修改密码

```mysql
mysql> use mysql;
mysql> update user set password=PASSWORD('MyNewPass5!') where user='root';
mysql> flush privileges;
```

`注意：mysql 5.7 默认安装了密码安全检查插件（validate_password），默认密码检查策略要求密码必须包含：大小写字母、数字和特殊符号，并且长度不能少于8位。否则会提示 ERROR 1819 (HY000): Your password does not satisfy the current policy requirements 错误。查看` [MySQL官网密码详细策略](https://links.jianshu.com/go?to=https%3A%2F%2Fdev.mysql.com%2Fdoc%2Frefman%2F5.7%2Fen%2Fvalidate-password-options-variables.html%23sysvar_validate_password_policy "https://links.jianshu.com/go?to=https%3A%2F%2Fdev.mysql.com%2Fdoc%2Frefman%2F5.7%2Fen%2Fvalidate-password-options-variables.html%23sysvar_validate_password_policy")


# 5.添加远程登录用户

默认只允许root帐户在本地登录，如果要在其它机器上连接mysql，必须添加一个允许远程连接的帐户。或者~~修改 root 为允许远程连接（不推荐）~~

#### 添加一个允许远程连接的帐户

```mysql
mysql> GRANT ALL PRIVILEGES ON *.* TO 'zhangsan'@'%' IDENTIFIED BY 'Zhangsan2018!' WITH GRANT OPTION;
```

~~修改 root 为允许远程连接（不推荐）~~

```mysql
mysql> use mysql;
mysql> UPDATE user SET Host='%' WHERE User='root';
mysql> flush privileges;
```

# 6.设置默认编码为utf8

mysql 安装后默认不支持中文，需要修改编码。修改 `/etc/my.cnf `配置文件，在相关节点（没有则自行添加）下添加编码配置，如下：


```
[mysqld]
character-set-server=utf8
[client]
default-character-set=utf8
[mysql]
default-character-set=utf8
```

重启mysql服务，查询编码。可以看到已经改过来了

```mysql
shell> systemctl restart mysqld
shell> mysql -uroot -p
mysql> show variables like 'character%';
```

# 7.默认配置文件路径

默认配置文件路径:
- 配置文件：`/etc/my.cnf`
- 日志文件：`/var/log/mysqld.log`
- 服务启动脚本：`/usr/lib/systemd/system/mysqld.service`
- socket文件：`/var/run/mysqld/mysqld.pid`











